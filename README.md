# SourceConcat.jl

[![CI](https://github.com/josePereiro/SourceConcat.jl/actions/workflows/CI.yml/badge.svg)](https://github.com/josePereiro/SourceConcat.jl/actions/workflows/CI.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Julia](https://img.shields.io/badge/julia-%5E1.10-blue?logo=julia)](https://julialang.org/)

> Concatenate your projectâ€™s source files into a single, navigable Markdown document â€” complete with syntax highlighting, table of contents, and clipboard export.

---

## âœ¨ Overview

**SourceConcat.jl** is a small Julia utility that walks your source tree, collects files matching configurable patterns, and concatenates them into a single Markdown file.

Itâ€™s ideal for:
- Preparing *context packs* for AI tools or documentation.
- Creating portable snapshots of your codebase.
- Rapid project summaries and shareable archives.

---

## âš™ï¸ Installation

You can install it directly in Julia:

```julia
using Pkg
Pkg.add(url="https://github.com/josePereiro/SourceConcat.jl.git")
````

---

## ğŸš€ Usage

1. Create a configuration file named `SourceConcat.json` in your project root.
2. Call `SourceConcat.concat()` from Julia.

Example:

```julia
using SourceConcat

concat(verbose = true)
```

### Output modes

| Mode               | Description                                                                    |
| ------------------ | ------------------------------------------------------------------------------ |
| `"file"`           | Write concatenated Markdown to `output.path`.                                  |
| `"clipboard-text"` | Copy concatenated text directly to the clipboard.                              |
| `"clipboard-file"` | Copy a *file reference* to the clipboard (Finder/Explorer/Nautilus pasteable). |

---

## ğŸ§© Example Configuration

```jsonc
{
  "root.paths": [ "." ],
  "output.path": "~/Documents/context.md",
  "output.mode": "clipboard-file",
  "include.files": [
    "*.jl",
    "*.md",
    "*Project.toml",
    "*SourceConcat.json"
  ],
  "exclude.files": [
    "_DEPRECATED/**",
    ".git/**",
    "dev/**"
  ],
  "use.gtignore": true
}
```

### Main keys

| Key             | Type             | Description                                         |
| --------------- | ---------------- | --------------------------------------------------- |
| `root.paths`    | `Vector{String}` | Root directories to walk through                    |
| `output.path`   | `String`         | Path for the output file                            |
| `output.mode`   | `String`         | `"file"`, `"clipboard-text"`, or `"clipboard-file"` |
| `include.files` | `Vector{String}` | Glob patterns to include                            |
| `exclude.files` | `Vector{String}` | Glob patterns to exclude                            |
| `use.gtignore`  | `Bool`           | Whether to respect `.gitignore` (future feature)    |

---

## ğŸ“‹ Clipboard File Support

When `output.mode` is `"clipboard-file"`, the concatenated Markdown is written to disk and a **file reference** is copied to your clipboard â€” allowing you to paste the file directly into Finder (macOS), Explorer (Windows), or GNOME/Nautilus (Linux).

### OS-specific backends

| Platform    | Backend             | Details                                                             |
| ----------- | ------------------- | ------------------------------------------------------------------- |
| **macOS**   | `osascript`         | Uses AppleScript: `set the clipboard to POSIX file "..."`           |
| **Windows** | `PowerShell`        | Uses `.NET` `System.Windows.Forms.Clipboard` via STA thread         |
| **Linux**   | `wl-copy` / `xclip` | Writes a GNOME-compatible MIME type: `x-special/gnome-copied-files` |

If neither `wl-copy` nor `xclip` is available, an error message will guide you.

Implementation: [`src/utils.clipboard.file.jl`](src/utils.clipboard.file.jl)

---

## ğŸ§  Example Output

A generated Markdown file looks like:

````markdown
<!-- Generated by SourceConcat.jl at 2025-11-08 10:15:44 -->

***
## TABLE OF CONTENTS

1. [Content of 'Project.toml'](#sc-1)
2. [Content of 'src/SourceConcat.jl'](#sc-2)
...

***
## 1 âŸ¦Project.tomlâŸ§
```toml
name = "SourceConcat"
...
````

````

---

## ğŸ§ª Development

Run the tests:

```julia
using Pkg
Pkg.test("SourceConcat")
````

Planned additions:

* `.gitignore` integration
* Parallel reading for large trees
* Command-line interface
* HTML / JSON export options

---

## ğŸ§± Project Structure

```
SourceConcat.jl/
â”œâ”€â”€ Project.toml
â”œâ”€â”€ SourceConcat.json          # example configuration
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ SourceConcat.jl
â”‚   â”œâ”€â”€ base.*.jl
â”‚   â”œâ”€â”€ utils.clipboard.file.jl
â”‚   â””â”€â”€ utils.lang.map.jl
â”œâ”€â”€ test/
â”‚   â””â”€â”€ runtests.jl
â””â”€â”€ notes/
```

---

## ğŸ“„ License

This project is licensed under the **MIT License**.
Â© 2025 [JosÃ© Pereiro](mailto:jose.pereiro.lab@gmail.com)

---

### ğŸ’¡ Tip

Combine `SourceConcat` with a scheduled task or GitHub Action to automatically generate a snapshot of your source tree for documentation or LLM context ingestion.

